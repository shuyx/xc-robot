<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>DEPLOYMENT_GUIDE</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    /* The extra [class] is a hack that increases specificity enough to
       override a similar rule in reveal.js */
    ul.task-list[class]{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      font-size: inherit;
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
    /* CSS for syntax highlighting */
    html { -webkit-text-size-adjust: 100%; }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="css/markdown.css" />
</head>
<body>
<header id="title-block-header">
<h1 class="title">DEPLOYMENT_GUIDE</h1>
</header>
<nav id="TOC" role="doc-toc">
<ul>
<li><a href="#fr3机械臂部署指南" id="toc-fr3机械臂部署指南"><span class="toc-section-number">1</span> FR3机械臂部署指南</a>
<ul>
<li><a href="#安装python依赖" id="toc-安装python依赖"><span class="toc-section-number">1.1</span> 1. 安装Python依赖</a></li>
<li><a href="#验证网络连接" id="toc-验证网络连接"><span class="toc-section-number">1.2</span> 2. 验证网络连接</a>
<ul>
<li><a href="#检查机械臂ip配置" id="toc-检查机械臂ip配置"><span class="toc-section-number">1.2.1</span> 2.1 检查机械臂IP配置</a></li>
<li><a href="#测试网络连通性" id="toc-测试网络连通性"><span class="toc-section-number">1.2.2</span> 2.2 测试网络连通性</a></li>
</ul></li>
<li><a href="#运行测试程序" id="toc-运行测试程序"><span class="toc-section-number">1.3</span> 3. 运行测试程序</a>
<ul>
<li><a href="#测试单个机械臂" id="toc-测试单个机械臂"><span class="toc-section-number">1.3.1</span> 3.1 测试单个机械臂</a></li>
<li><a href="#测试双臂连接" id="toc-测试双臂连接"><span class="toc-section-number">1.3.2</span> 3.2 测试双臂连接</a></li>
<li><a href="#测试集成控制器完整流程" id="toc-测试集成控制器完整流程"><span class="toc-section-number">1.3.3</span> 3.3 测试集成控制器（完整流程）</a></li>
</ul></li>
<li><a href="#使用指南" id="toc-使用指南"><span class="toc-section-number">1.4</span> 4. 使用指南</a>
<ul>
<li><a href="#编程接口" id="toc-编程接口"><span class="toc-section-number">1.4.1</span> 4.1 编程接口</a></li>
<li><a href="#运行模式" id="toc-运行模式"><span class="toc-section-number">1.4.2</span> 4.2 运行模式</a></li>
</ul></li>
<li><a href="#注意事项" id="toc-注意事项"><span class="toc-section-number">1.5</span> 5. 注意事项</a></li>
<li><a href="#常见问题" id="toc-常见问题"><span class="toc-section-number">1.6</span> 6. 常见问题</a>
<ul>
<li><a href="#q-提示fairino模块导入失败" id="toc-q-提示fairino模块导入失败"><span class="toc-section-number">1.6.1</span> Q: 提示”fairino模块导入失败”</a></li>
<li><a href="#q-连接超时" id="toc-q-连接超时"><span class="toc-section-number">1.6.2</span> Q: 连接超时</a></li>
<li><a href="#q-运动指令返回错误码" id="toc-q-运动指令返回错误码"><span class="toc-section-number">1.6.3</span> Q: 运动指令返回错误码</a></li>
</ul></li>
<li><a href="#底盘相对移动控制" id="toc-底盘相对移动控制"><span class="toc-section-number">1.7</span> 7. 底盘相对移动控制</a>
<ul>
<li><a href="#功能说明" id="toc-功能说明"><span class="toc-section-number">1.7.1</span> 7.1 功能说明</a></li>
<li><a href="#使用方法" id="toc-使用方法"><span class="toc-section-number">1.7.2</span> 7.2 使用方法</a></li>
<li><a href="#控制选项" id="toc-控制选项"><span class="toc-section-number">1.7.3</span> 7.3 控制选项</a></li>
<li><a href="#实现效果" id="toc-实现效果"><span class="toc-section-number">1.7.4</span> 7.4 实现效果</a></li>
<li><a href="#故障排查工具" id="toc-故障排查工具"><span class="toc-section-number">1.7.5</span> 7.5 故障排查工具</a></li>
</ul></li>
<li><a href="#gui界面优化" id="toc-gui界面优化"><span class="toc-section-number">1.8</span> 8. GUI界面优化</a>
<ul>
<li><a href="#跨平台字体兼容性修复" id="toc-跨平台字体兼容性修复"><span class="toc-section-number">1.8.1</span> 8.1 跨平台字体兼容性修复</a></li>
<li><a href="#仿真界面标尺优化" id="toc-仿真界面标尺优化"><span class="toc-section-number">1.8.2</span> 8.2 仿真界面标尺优化</a></li>
<li><a href="#依赖环境配置" id="toc-依赖环境配置"><span class="toc-section-number">1.8.3</span> 8.3 依赖环境配置</a></li>
</ul></li>
<li><a href="#底盘仿真界面控制增强" id="toc-底盘仿真界面控制增强"><span class="toc-section-number">1.9</span> 9. 底盘仿真界面控制增强</a>
<ul>
<li><a href="#新增功能概述" id="toc-新增功能概述"><span class="toc-section-number">1.9.1</span> 9.1 新增功能概述</a></li>
<li><a href="#功能详细说明" id="toc-功能详细说明"><span class="toc-section-number">1.9.2</span> 9.2 功能详细说明</a></li>
<li><a href="#代码修改内容" id="toc-代码修改内容"><span class="toc-section-number">1.9.3</span> 9.3 代码修改内容</a></li>
<li><a href="#使用指南-1" id="toc-使用指南-1"><span class="toc-section-number">1.9.4</span> 9.4 使用指南</a></li>
<li><a href="#预期效果验证" id="toc-预期效果验证"><span class="toc-section-number">1.9.5</span> 9.5 预期效果验证</a></li>
</ul></li>
<li><a href="#仿真界面布局优化" id="toc-仿真界面布局优化"><span class="toc-section-number">1.10</span> 10. 仿真界面布局优化</a>
<ul>
<li><a href="#问题描述-1" id="toc-问题描述-1"><span class="toc-section-number">1.10.1</span> 10.1 问题描述</a></li>
<li><a href="#优化内容-1" id="toc-优化内容-1"><span class="toc-section-number">1.10.2</span> 10.2 优化内容</a></li>
<li><a href="#优化效果" id="toc-优化效果"><span class="toc-section-number">1.10.3</span> 10.3 优化效果</a></li>
<li><a href="#兼容性保持" id="toc-兼容性保持"><span class="toc-section-number">1.10.4</span> 10.4 兼容性保持</a></li>
</ul></li>
<li><a href="#双臂机械臂仿真轨迹系统" id="toc-双臂机械臂仿真轨迹系统"><span class="toc-section-number">1.11</span> 11. 双臂机械臂仿真轨迹系统</a>
<ul>
<li><a href="#功能概述" id="toc-功能概述"><span class="toc-section-number">1.11.1</span> 11.1 功能概述</a></li>
<li><a href="#机器人物理结构配置" id="toc-机器人物理结构配置"><span class="toc-section-number">1.11.2</span> 11.2 机器人物理结构配置</a></li>
<li><a href="#核心程序模块" id="toc-核心程序模块"><span class="toc-section-number">1.11.3</span> 11.3 核心程序模块</a></li>
<li><a href="#内置测试轨迹" id="toc-内置测试轨迹"><span class="toc-section-number">1.11.4</span> 11.4 内置测试轨迹</a></li>
<li><a href="#使用方法-1" id="toc-使用方法-1"><span class="toc-section-number">1.11.5</span> 11.5 使用方法</a></li>
<li><a href="#技术特点" id="toc-技术特点"><span class="toc-section-number">1.11.6</span> 11.6 技术特点</a></li>
<li><a href="#调试和验证" id="toc-调试和验证"><span class="toc-section-number">1.11.7</span> 11.7 调试和验证</a></li>
<li><a href="#fr3-api深度理解和轨迹实现方式" id="toc-fr3-api深度理解和轨迹实现方式"><span class="toc-section-number">1.11.8</span> 11.8 FR3 API深度理解和轨迹实现方式</a></li>
</ul></li>
<li><a href="#机械臂仿真信息面板自适应优化" id="toc-机械臂仿真信息面板自适应优化"><span class="toc-section-number">1.12</span> 12. 机械臂仿真信息面板自适应优化</a>
<ul>
<li><a href="#问题描述-2" id="toc-问题描述-2"><span class="toc-section-number">1.12.1</span> 12.1 问题描述</a></li>
<li><a href="#优化方案" id="toc-优化方案"><span class="toc-section-number">1.12.2</span> 12.2 优化方案</a></li>
<li><a href="#优化效果-1" id="toc-优化效果-1"><span class="toc-section-number">1.12.3</span> 12.3 优化效果</a></li>
<li><a href="#代码实现要点" id="toc-代码实现要点"><span class="toc-section-number">1.12.4</span> 12.4 代码实现要点</a></li>
<li><a href="#应用价值-1" id="toc-应用价值-1"><span class="toc-section-number">1.12.5</span> 12.5 应用价值</a></li>
</ul></li>
<li><a href="#gui启动问题解决方案" id="toc-gui启动问题解决方案"><span class="toc-section-number">1.13</span> 13. GUI启动问题解决方案</a>
<ul>
<li><a href="#问题历史" id="toc-问题历史"><span class="toc-section-number">1.13.1</span> 13.1 问题历史</a></li>
<li><a href="#根本原因分析" id="toc-根本原因分析"><span class="toc-section-number">1.13.2</span> 13.2 根本原因分析</a></li>
<li><a href="#解决方案-1" id="toc-解决方案-1"><span class="toc-section-number">1.13.3</span> 13.3 解决方案</a></li>
<li><a href="#当前状态" id="toc-当前状态"><span class="toc-section-number">1.13.4</span> 13.4 当前状态</a></li>
<li><a href="#使用方法-2" id="toc-使用方法-2"><span class="toc-section-number">1.13.5</span> 13.5 使用方法</a></li>
<li><a href="#技术细节" id="toc-技术细节"><span class="toc-section-number">1.13.6</span> 13.6 技术细节</a></li>
</ul></li>
<li><a href="#下一步" id="toc-下一步"><span class="toc-section-number">1.14</span> 14. 下一步</a></li>
</ul></li>
</ul>
</nav>
<h1 data-number="1" id="fr3机械臂部署指南"><span class="header-section-number">1</span> FR3机械臂部署指南</h1>
<h2 data-number="1.1" id="安装python依赖"><span class="header-section-number">1.1</span> 1. 安装Python依赖</h2>
<p>在VS Code终端中运行：</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 激活虚拟环境</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="bu">.</span><span class="dt">\v</span>env<span class="dt">\S</span>cripts<span class="dt">\a</span>ctivate</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 安装依赖</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> install <span class="at">-r</span> requirements.txt</span></code></pre></div>
<h2 data-number="1.2" id="验证网络连接"><span class="header-section-number">1.2</span> 2. 验证网络连接</h2>
<h3 data-number="1.2.1" id="检查机械臂ip配置"><span class="header-section-number">1.2.1</span> 2.1 检查机械臂IP配置</h3>
<ul>
<li>右臂IP: 192.168.58.2</li>
<li>左臂IP: 192.168.58.3</li>
<li>Hermes底盘: http://192.168.31.211:1448</li>
</ul>
<h3 data-number="1.2.2" id="测试网络连通性"><span class="header-section-number">1.2.2</span> 2.2 测试网络连通性</h3>
<p>在命令行中ping测试：</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ping</span> 192.168.58.2</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ping</span> 192.168.58.3</span></code></pre></div>
<h2 data-number="1.3" id="运行测试程序"><span class="header-section-number">1.3</span> 3. 运行测试程序</h2>
<h3 data-number="1.3.1" id="测试单个机械臂"><span class="header-section-number">1.3.1</span> 3.1 测试单个机械臂</h3>
<div class="sourceCode" id="cb3"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 测试右臂</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> tests/fr3_simple_test.py 192.168.58.2</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 测试左臂</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> tests/fr3_simple_test.py 192.168.58.3</span></code></pre></div>
<h3 data-number="1.3.2" id="测试双臂连接"><span class="header-section-number">1.3.2</span> 3.2 测试双臂连接</h3>
<div class="sourceCode" id="cb4"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> tests/dual_arm_connection.py</span></code></pre></div>
<h3 data-number="1.3.3" id="测试集成控制器完整流程"><span class="header-section-number">1.3.3</span> 3.3 测试集成控制器（完整流程）</h3>
<div class="sourceCode" id="cb5"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> main_control/integrated_controller.py</span></code></pre></div>
<h2 data-number="1.4" id="使用指南"><span class="header-section-number">1.4</span> 4. 使用指南</h2>
<h3 data-number="1.4.1" id="编程接口"><span class="header-section-number">1.4.1</span> 4.1 编程接口</h3>
<div class="sourceCode" id="cb6"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> fr3_control.fairino <span class="im">import</span> Robot</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 连接机械臂</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>robot <span class="op">=</span> Robot.RPC(<span class="st">&quot;192.168.58.2&quot;</span>)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 设置模式和使能</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>robot.Mode(<span class="dv">0</span>)  <span class="co"># 自动模式</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>robot.RobotEnable(<span class="dv">1</span>)  <span class="co"># 使能</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="co"># 执行运动</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>robot.MoveJ([<span class="dv">0</span>, <span class="op">-</span><span class="dv">20</span>, <span class="op">-</span><span class="dv">90</span>, <span class="op">-</span><span class="dv">90</span>, <span class="dv">90</span>, <span class="dv">0</span>], tool<span class="op">=</span><span class="dv">0</span>, user<span class="op">=</span><span class="dv">0</span>, vel<span class="op">=</span><span class="dv">20</span>)</span></code></pre></div>
<h3 data-number="1.4.2" id="运行模式"><span class="header-section-number">1.4.2</span> 4.2 运行模式</h3>
<p>集成控制器支持三种模式： 1. <strong>交互控制模式</strong> - 手动选择任务 2. <strong>标准任务模式</strong> - 执行预定义流程 3. <strong>状态测试模式</strong> - 仅检查系统状态</p>
<h2 data-number="1.5" id="注意事项"><span class="header-section-number">1.5</span> 5. 注意事项</h2>
<ol type="1">
<li><strong>安全第一</strong>
<ul>
<li>首次运行请确保机械臂周围有足够空间</li>
<li>使用较低速度（10-20%）进行测试</li>
<li>准备好急停按钮</li>
</ul></li>
<li><strong>网络配置</strong>
<ul>
<li>确保主机与机械臂在同一网段</li>
<li>防火墙可能需要允许相关端口</li>
</ul></li>
<li><strong>错误处理</strong>
<ul>
<li>如果连接失败，检查机械臂控制器是否开启</li>
<li>确认机械臂处于远程控制模式</li>
</ul></li>
</ol>
<h2 data-number="1.6" id="常见问题"><span class="header-section-number">1.6</span> 6. 常见问题</h2>
<h3 data-number="1.6.1" id="q-提示fairino模块导入失败"><span class="header-section-number">1.6.1</span> Q: 提示”fairino模块导入失败”</h3>
<p>A: 确保在项目根目录运行，fr3_control文件夹包含fairino模块</p>
<h3 data-number="1.6.2" id="q-连接超时"><span class="header-section-number">1.6.2</span> Q: 连接超时</h3>
<p>A: 检查网络连接和IP地址配置</p>
<h3 data-number="1.6.3" id="q-运动指令返回错误码"><span class="header-section-number">1.6.3</span> Q: 运动指令返回错误码</h3>
<p>A: 查看fr3 pdf文件夹中的错误码对照表</p>
<h2 data-number="1.7" id="底盘相对移动控制"><span class="header-section-number">1.7</span> 7. 底盘相对移动控制</h2>
<p><em>更新时间：2025-01-07 17:30</em></p>
<h3 data-number="1.7.1" id="功能说明"><span class="header-section-number">1.7.1</span> 7.1 功能说明</h3>
<p>新增底盘相对移动控制程序，支持基于当前位置的相对运动控制。</p>
<h3 data-number="1.7.2" id="使用方法"><span class="header-section-number">1.7.2</span> 7.2 使用方法</h3>
<div class="sourceCode" id="cb7"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 在项目根目录运行</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> function_test/chassis_relative_move.py</span></code></pre></div>
<h3 data-number="1.7.3" id="控制选项"><span class="header-section-number">1.7.3</span> 7.3 控制选项</h3>
<ul>
<li><strong>前进/后退</strong> - 沿当前朝向移动指定距离(米)</li>
<li><strong>左移/右移</strong> - 垂直于当前朝向平移指定距离(米)<br />
</li>
<li><strong>左转/右转</strong> - 原地旋转指定角度(度)</li>
</ul>
<h3 data-number="1.7.4" id="实现效果"><span class="header-section-number">1.7.4</span> 7.4 实现效果</h3>
<ol type="1">
<li>自动获取底盘当前坐标和朝向</li>
<li>终端交互式选择运动方向</li>
<li>输入移动距离或转向角度</li>
<li>计算目标位置并执行移动</li>
<li>实时反馈运动状态</li>
</ol>
<h3 data-number="1.7.5" id="故障排查工具"><span class="header-section-number">1.7.5</span> 7.5 故障排查工具</h3>
<p><em>更新时间：2025-01-07 18:00</em></p>
<h4 data-number="1.7.5.1" id="action类型检查"><span class="header-section-number">1.7.5.1</span> 7.5.1 Action类型检查</h4>
<div class="sourceCode" id="cb8"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> function_test/check_action_factories.py</span></code></pre></div>
<p>功能：查询底盘支持的所有action类型，验证API接口</p>
<h4 data-number="1.7.5.2" id="刹车状态复位"><span class="header-section-number">1.7.5.2</span> 7.5.2 刹车状态复位</h4>
<div class="sourceCode" id="cb9"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> function_test/chassis_reset_brake.py</span></code></pre></div>
<p>功能： - 检查底盘状态信息 - 尝试复位电机刹车 - 解决”motor brake released”错误（错误码：33621760）</p>
<p>常见错误处理： - <strong>CANNOT_REACH_TARGET</strong>: 目标位置不可达，建议减小移动距离 - <strong>motor brake released</strong>: 电机刹车释放，需要复位或检查急停按钮</p>
<h2 data-number="1.8" id="gui界面优化"><span class="header-section-number">1.8</span> 8. GUI界面优化</h2>
<p><em>更新时间：2025-01-07 20:15</em></p>
<h3 data-number="1.8.1" id="跨平台字体兼容性修复"><span class="header-section-number">1.8.1</span> 8.1 跨平台字体兼容性修复</h3>
<p>修复了Mac系统下GUI按钮文字不显示的问题：</p>
<h4 data-number="1.8.1.1" id="问题描述"><span class="header-section-number">1.8.1.1</span> 8.1.1 问题描述</h4>
<ul>
<li>Windows系统使用”Microsoft YaHei”字体正常显示</li>
<li>Mac系统缺少该字体，导致按钮文字为空白</li>
<li>特别是仿真界面的”播放底盘”、“暂停”、“停止”等按钮</li>
</ul>
<h4 data-number="1.8.1.2" id="解决方案"><span class="header-section-number">1.8.1.2</span> 8.1.2 解决方案</h4>
<ol type="1">
<li><p><strong>设置字体回退机制</strong>：</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>font <span class="op">=</span> QFont()</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>font.setFamily(<span class="st">&quot;PingFang SC, Helvetica, Microsoft YaHei, Arial&quot;</span>)</span></code></pre></div></li>
<li><p><strong>移除emoji字符</strong>：</p>
<ul>
<li>替换<code>▶️ 播放底盘</code> → <code>播放底盘</code></li>
<li>替换<code>⏸️ 暂停</code> → <code>暂停</code></li>
<li>替换<code>⏹️ 停止</code> → <code>停止</code></li>
<li>替换<code>🔄 重置</code> → <code>重置</code></li>
</ul></li>
<li><p><strong>修改的文件</strong>：</p>
<ul>
<li><code>start_gui.py</code>：全局字体设置</li>
<li><code>gui/main_window.py</code>：主窗口字体设置</li>
<li><code>gui/gui_main.py</code>：GUI主程序字体设置</li>
<li><code>gui/widgets/simulation_widget.py</code>：仿真控件按钮字体设置</li>
</ul></li>
</ol>
<h3 data-number="1.8.2" id="仿真界面标尺优化"><span class="header-section-number">1.8.2</span> 8.2 仿真界面标尺优化</h3>
<p>改进了仿真界面右上角的标尺显示：</p>
<h4 data-number="1.8.2.1" id="优化内容"><span class="header-section-number">1.8.2.1</span> 8.2.1 优化内容</h4>
<ol type="1">
<li><strong>单位标准化</strong>：从毫米(mm)改为米(m)</li>
<li><strong>去除背景</strong>：移除白色背景框，界面更简洁</li>
<li><strong>视觉优化</strong>：使用黑色加粗线条，提高清晰度</li>
<li><strong>信息精简</strong>：只显示关键的网格尺寸信息</li>
</ol>
<h4 data-number="1.8.2.2" id="显示效果"><span class="header-section-number">1.8.2.2</span> 8.2.2 显示效果</h4>
<ul>
<li>标尺显示：<code>0</code> ━━━━━━━━━━ <code>0.5m</code></li>
<li>网格信息：<code>网格: 0.25m</code></li>
<li>位置：右上角，无背景干扰</li>
</ul>
<h3 data-number="1.8.3" id="依赖环境配置"><span class="header-section-number">1.8.3</span> 8.3 依赖环境配置</h3>
<h4 data-number="1.8.3.1" id="python虚拟环境"><span class="header-section-number">1.8.3.1</span> 8.3.1 Python虚拟环境</h4>
<div class="sourceCode" id="cb11"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 创建虚拟环境</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="ex">python3</span> <span class="at">-m</span> venv venv</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 激活虚拟环境</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="bu">source</span> venv/bin/activate  <span class="co"># Mac/Linux</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 或</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="bu">.</span><span class="dt">\v</span>env<span class="dt">\S</span>cripts<span class="dt">\a</span>ctivate   <span class="co"># Windows</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="co"># 安装依赖</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> install <span class="at">-r</span> requirements.txt</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> install PyQt5  <span class="co"># GUI界面支持</span></span></code></pre></div>
<h4 data-number="1.8.3.2" id="跨平台兼容性"><span class="header-section-number">1.8.3.2</span> 8.3.2 跨平台兼容性</h4>
<p>现在GUI界面支持： - ✅ Windows 10/11 - ✅ macOS (Intel/Apple Silicon) - ✅ Linux (Ubuntu/Debian)</p>
<h2 data-number="1.9" id="底盘仿真界面控制增强"><span class="header-section-number">1.9</span> 9. 底盘仿真界面控制增强</h2>
<p><em>更新时间：2025-01-07 23:00</em></p>
<h3 data-number="1.9.1" id="新增功能概述"><span class="header-section-number">1.9.1</span> 9.1 新增功能概述</h3>
<p>在底盘运动仿真界面新增三个控制按钮和交互式路径绘制功能，提供完整的路径设计和仿真控制能力。</p>
<h3 data-number="1.9.2" id="功能详细说明"><span class="header-section-number">1.9.2</span> 9.2 功能详细说明</h3>
<h4 data-number="1.9.2.1" id="xy方向切换按钮-xy切换"><span class="header-section-number">1.9.2.1</span> 9.2.1 X/Y方向切换按钮 (<code>🔄 X/Y切换</code>)</h4>
<p><strong>功能描述</strong>： - 一键切换X轴和Y轴的方向 - 坐标系箭头会相应反转方向 - 以坐标轴构成矩形的对角线角点为新坐标系原点</p>
<p><strong>技术实现</strong>： - 新增 <code>coordinate_origin</code> 变量跟踪坐标系原点位置 - 实现动态原点逻辑，确保轴向反转后坐标系仍在可见区域 - 修改 <code>draw_coordinate_system</code> 方法支持轴向反转显示</p>
<p><strong>使用效果</strong>：</p>
<pre><code>默认状态: 原点(30,30), X轴→, Y轴↓
切换后: 原点(70,70), X轴←, Y轴↑
再次切换: 恢复原状态</code></pre>
<h4 data-number="1.9.2.2" id="旋转按钮-90旋转"><span class="header-section-number">1.9.2.2</span> 9.2.2 90°旋转按钮 (<code>🔄 90°旋转</code>)</h4>
<p><strong>功能描述</strong>： - 底盘矩形围绕当前质心旋转90° - 红色方向箭头保持原方向不变 - 点击一次旋转90°，连续点击可实现180°、270°、360°旋转</p>
<p><strong>技术实现</strong>： - 新增 <code>chassis_rotation_offset</code> 变量控制额外旋转角度 - 分离底盘矩形和方向箭头的绘制逻辑 - 矩形应用 <code>chassis_angle + chassis_rotation_offset</code> - 箭头仅应用原始 <code>chassis_angle</code></p>
<p><strong>绘制分离</strong>：</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. 绘制底盘矩形（受rotation_offset影响）</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>painter.rotate(<span class="va">self</span>.chassis_angle <span class="op">+</span> <span class="va">self</span>.chassis_rotation_offset)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>painter.drawRect(...)  <span class="co"># 橘黄色矩形</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. 绘制方向箭头（不受rotation_offset影响）</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>painter.rotate(<span class="va">self</span>.chassis_angle)  <span class="co"># 只使用原始角度</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>painter.drawPolygon(...)  <span class="co"># 红色箭头</span></span></code></pre></div>
<h3 data-number="1.9.3" id="代码修改内容"><span class="header-section-number">1.9.3</span> 9.3 代码修改内容</h3>
<h4 data-number="1.9.3.1" id="新增状态变量"><span class="header-section-number">1.9.3.1</span> 9.3.1 新增状态变量</h4>
<div class="sourceCode" id="cb14"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ChassisSimulationWidget类新增：</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="va">self</span>.x_inverted <span class="op">=</span> <span class="va">False</span>  <span class="co"># X轴是否反向</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="va">self</span>.y_inverted <span class="op">=</span> <span class="va">False</span>  <span class="co"># Y轴是否反向</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="va">self</span>.chassis_rotation_offset <span class="op">=</span> <span class="dv">0</span>  <span class="co"># 底盘额外旋转角度</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="va">self</span>.coordinate_origin <span class="op">=</span> [<span class="dv">30</span>, <span class="dv">30</span>]  <span class="co"># 坐标系原点位置</span></span></code></pre></div>
<h4 data-number="1.9.3.2" id="新增控制方法"><span class="header-section-number">1.9.3.2</span> 9.3.2 新增控制方法</h4>
<div class="sourceCode" id="cb15"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> toggle_xy_direction(<span class="va">self</span>):</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;切换X/Y轴方向，以对角线角点为新原点&quot;&quot;&quot;</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> rotate_chassis_90(<span class="va">self</span>):</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;底盘矩形旋转90度（不影响红色箭头）&quot;&quot;&quot;</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> clear_chassis_path(<span class="va">self</span>):</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;清除底盘路径&quot;&quot;&quot;</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="co"># 交互式路径绘制</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> mousePressEvent(<span class="va">self</span>, event):     <span class="co"># 开始绘制路径</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> mouseMoveEvent(<span class="va">self</span>, event):      <span class="co"># 实时绘制预览</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> mouseReleaseEvent(<span class="va">self</span>, event):   <span class="co"># 完成绘制</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> show_path_statistics(<span class="va">self</span>):       <span class="co"># 显示路径统计</span></span></code></pre></div>
<h4 data-number="1.9.3.3" id="修改的文件"><span class="header-section-number">1.9.3.3</span> 9.3.3 修改的文件</h4>
<ul>
<li><code>gui/widgets/simulation_widget.py</code>：主要功能实现</li>
<li>新增三个UI按钮和信号连接</li>
<li>修改坐标系和底盘绘制方法</li>
<li>新增路径清除功能</li>
</ul>
<h3 data-number="1.9.4" id="使用指南-1"><span class="header-section-number">1.9.4</span> 9.4 使用指南</h3>
<h4 data-number="1.9.4.1" id="启动仿真界面"><span class="header-section-number">1.9.4.1</span> 9.4.1 启动仿真界面</h4>
<div class="sourceCode" id="cb16"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 运行GUI主程序</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> start_gui.py</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 或直接测试仿真界面</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> test_simulation.py</span></code></pre></div>
<h4 data-number="1.9.4.2" id="操作步骤"><span class="header-section-number">1.9.4.2</span> 9.4.2 操作步骤</h4>
<ol type="1">
<li>在GUI界面选择”仿真系统”标签页</li>
<li>观察”底盘运动仿真”区域的橘黄色矩形和红色箭头</li>
<li>点击 <code>🔄 X/Y切换</code> 按钮测试坐标轴反转</li>
<li>点击 <code>🔄 90°旋转</code> 按钮测试矩形旋转（箭头方向不变）</li>
<li>点击 <code>🗑️ 清除路径</code> 按钮测试路径清除功能</li>
<li>在网格上拖拽鼠标绘制自定义路径（按住左键拖拽）</li>
</ol>
<h3 data-number="1.9.5" id="预期效果验证"><span class="header-section-number">1.9.5</span> 9.5 预期效果验证</h3>
<h4 data-number="1.9.5.1" id="xy切换效果"><span class="header-section-number">1.9.5.1</span> 9.5.1 X/Y切换效果</h4>
<ul>
<li>✅ 坐标轴箭头方向反转</li>
<li>✅ 原点移动到对角线位置</li>
<li>✅ 显示内容保持在可见区域</li>
<li>✅ 日志显示”已切换X/Y轴方向”</li>
</ul>
<h4 data-number="1.9.5.2" id="旋转效果"><span class="header-section-number">1.9.5.2</span> 9.5.2 90°旋转效果</h4>
<ul>
<li>✅ 橘黄色底盘矩形围绕质心旋转</li>
<li>✅ 红色方向箭头保持原方向</li>
<li>✅ 矩形上的”HERMES”标识跟随旋转</li>
<li>✅ 日志显示”底盘矩形已旋转90度”</li>
</ul>
<h4 data-number="1.9.5.3" id="清除路径功能-清除路径"><span class="header-section-number">1.9.5.3</span> 9.5.3 清除路径功能 (<code>🗑️ 清除路径</code>)</h4>
<p><em>更新时间：2025-01-07 23:00</em></p>
<p><strong>功能描述</strong>： - 一键清除底盘运动仿真中的所有蓝色路径线条 - 重置动画状态和进度条 - 保持底盘当前位置和朝向不变</p>
<p><strong>技术实现</strong>：</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> clear_path(<span class="va">self</span>):</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;清除路径点和重置状态&quot;&quot;&quot;</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>    <span class="va">self</span>.path_points <span class="op">=</span> []           <span class="co"># 清空路径点列表</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    <span class="va">self</span>.current_path_index <span class="op">=</span> <span class="dv">0</span>     <span class="co"># 重置当前索引</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>    <span class="va">self</span>.stop_animation()           <span class="co"># 停止动画</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>    <span class="va">self</span>.update()                   <span class="co"># 刷新显示</span></span></code></pre></div>
<p><strong>清除内容</strong>： - ✅ 蓝色路径连接线 - ✅ 蓝色/红色路径点圆圈 - ✅ 路径点方向箭头 - ✅ 动画进度条重置为0% - ✅ 停止正在播放的路径动画</p>
<p><strong>保留内容</strong>： - ✅ 底盘矩形和红色方向箭头（当前位置） - ✅ 网格线和坐标系显示 - ✅ 比例尺和标识信息</p>
<p><strong>使用场景</strong>： - 加载新的路径数据前清除旧路径 - 重新开始路径规划时清空显示 - 调试时快速清除测试路径 - 演示时重置仿真状态</p>
<p><strong>操作效果验证</strong>： - ✅ 点击按钮后蓝色路径立即消失 - ✅ 进度条显示”0%” - ✅ 动画停止播放 - ✅ 日志显示”已清除底盘路径” - ✅ 底盘位置和方向保持不变</p>
<h4 data-number="1.9.5.4" id="交互式路径绘制功能"><span class="header-section-number">1.9.5.4</span> 9.5.4 交互式路径绘制功能</h4>
<p><em>更新时间：2025-01-07 23:15</em></p>
<p><strong>功能描述</strong>： - 通过鼠标拖拽在网格上直接绘制底盘移动路径 - 自动对齐网格，确保路径规整 - 实时预览绘制过程，完成后显示统计信息</p>
<p><strong>操作方式</strong>： 1. 在底盘仿真网格区域按下鼠标左键开始绘制 2. 拖拽鼠标移动，路径自动对齐到网格交点 3. 释放鼠标左键完成绘制</p>
<p><strong>视觉效果</strong>： - 🟠 <strong>橙色线条</strong>：绘制过程中的实时预览 - 🟢 <strong>绿色圆圈</strong>：起始点特殊标记<br />
- 🔵 <strong>蓝色线条</strong>：完成后的最终路径 - ➡️ <strong>红色箭头</strong>：自动跟随拖拽方向</p>
<p><strong>自动统计</strong>： 完成绘制后弹框显示： - 总移动距离（米） - 路径线段数量 - 基于250mm网格实际尺寸计算</p>
<p><strong>技术特性</strong>： - ✅ 网格对齐约束，确保路径可执行 - ✅ 8方向移动支持（水平、垂直、对角线） - ✅ 实时方向角度计算 - ✅ 路径替换现有测试数据 - ✅ 与动画播放系统无缝集成</p>
<p><strong>使用提示</strong>： - 界面显示：“💡 提示：在网格上拖拽鼠标可以绘制底盘路径” - 可与清除路径功能配合使用 - 绘制完成的路径可直接用于动画播放</p>
<h2 data-number="1.10" id="仿真界面布局优化"><span class="header-section-number">1.10</span> 10. 仿真界面布局优化</h2>
<p><em>更新时间：2025-07-08 15:30</em></p>
<h3 data-number="1.10.1" id="问题描述-1"><span class="header-section-number">1.10.1</span> 10.1 问题描述</h3>
<p>原始底盘仿真界面存在布局问题： - 控制按钮周围空白过多，占用大量垂直空间 - 网格显示区域被压缩，影响仿真观察效果 - 界面空间利用率低，用户体验不佳</p>
<h3 data-number="1.10.2" id="优化内容-1"><span class="header-section-number">1.10.2</span> 10.2 优化内容</h3>
<h4 data-number="1.10.2.1" id="按钮布局紧凑化"><span class="header-section-number">1.10.2.1</span> 10.2.1 按钮布局紧凑化</h4>
<p><strong>优化措施</strong>： - 移除按钮表情符号，减少文字长度 - 按钮尺寸优化：宽度70px，高度25px - 字体大小调整：从8pt减小到7pt - 间距控制：设置5px间距，减少边距</p>
<p><strong>代码改进</strong>：</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 紧凑布局设置</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>chassis_title_layout.setSpacing(<span class="dv">5</span>)  <span class="co"># 减少间距</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>chassis_title_layout.setContentsMargins(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">5</span>)  <span class="co"># 减少边距</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 按钮尺寸优化</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>button.setMaximumWidth(<span class="dv">70</span>)</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>button.setMaximumHeight(<span class="dv">25</span>)</span></code></pre></div>
<h4 data-number="1.10.2.2" id="网格显示区域扩大"><span class="header-section-number">1.10.2.2</span> 10.2.2 网格显示区域扩大</h4>
<p><strong>优化措施</strong>： - 底盘仿真控件最小高度：300px → 400px - 主布局拉伸比例：显示区域4:控制区域1 - 提示文字简化：移除表情符号，使用斜体样式</p>
<p><strong>空间分配</strong>：</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 设置拉伸比例，优先保证显示区域</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>layout.addLayout(display_layout, <span class="dv">4</span>)  <span class="co"># 显示区域占4份</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>layout.addLayout(control_layout, <span class="dv">1</span>)  <span class="co"># 控制区域占1份</span></span></code></pre></div>
<h4 data-number="1.10.2.3" id="视觉优化"><span class="header-section-number">1.10.2.3</span> 10.2.3 视觉优化</h4>
<p><strong>改进效果</strong>： - 按钮文字：“🔄 X/Y切换” → “X/Y切换” - 提示文字：“💡 拖拽鼠标绘制路径” → “拖拽鼠标绘制路径” - 文字样式：灰色斜体，更加简洁</p>
<h3 data-number="1.10.3" id="优化效果"><span class="header-section-number">1.10.3</span> 10.3 优化效果</h3>
<ul>
<li>✅ <strong>空间利用率提升</strong>：网格显示区域增加约30%</li>
<li>✅ <strong>视觉清晰度改善</strong>：按钮布局更紧凑整齐</li>
<li>✅ <strong>操作体验优化</strong>：更大的仿真观察区域</li>
<li>✅ <strong>界面简洁化</strong>：移除不必要的装饰元素</li>
</ul>
<h3 data-number="1.10.4" id="兼容性保持"><span class="header-section-number">1.10.4</span> 10.4 兼容性保持</h3>
<ul>
<li>保持所有原有功能完整性</li>
<li>跨平台字体兼容性不受影响</li>
<li>交互逻辑完全保持不变</li>
</ul>
<h2 data-number="1.11" id="双臂机械臂仿真轨迹系统"><span class="header-section-number">1.11</span> 11. 双臂机械臂仿真轨迹系统</h2>
<p><em>更新时间：2025-07-08 16:30</em></p>
<h3 data-number="1.11.1" id="功能概述"><span class="header-section-number">1.11.1</span> 11.1 功能概述</h3>
<p>在<code>function_test</code>目录中新增双臂机械臂仿真轨迹测试程序，基于FR3 API和精确机器人尺寸参数，生成内置测试轨迹用于调试仿真系统。该系统无需实际连接机器人即可运行。</p>
<h3 data-number="1.11.2" id="机器人物理结构配置"><span class="header-section-number">1.11.2</span> 11.2 机器人物理结构配置</h3>
<h4 data-number="1.11.2.1" id="精确尺寸参数-基于提供的技术规格"><span class="header-section-number">1.11.2.1</span> 11.2.1 精确尺寸参数 (基于提供的技术规格)</h4>
<p><strong>整体结构</strong>： - 底盘直径: 500mm (估算) - 底盘高度: 250mm (估算) - 升降轴高度: 300mm (估算) - 胸部宽度: 380mm (精确值)</p>
<p><strong>FR3机械臂连杆尺寸</strong>： - 基座到J2距离: 140mm - 大臂连杆长度 (J2-J3): 280mm<br />
- 小臂连杆长度 (J3-J5): 240mm - 腕部到法兰距离 (J5-法兰): 100mm - <strong>单臂最大臂展</strong>: 620mm</p>
<p><strong>双臂安装配置</strong>： - 左右臂基座间距: 380mm (胸部宽度) - 左臂偏移: X=-190mm (相对胸部中心) - 右臂偏移: X=+190mm (相对胸部中心)</p>
<h4 data-number="1.11.2.2" id="坐标系定义"><span class="header-section-number">1.11.2.2</span> 11.2.2 坐标系定义</h4>
<p>采用类人形双臂配置，左右机械臂对称安装在胸部两侧，确保各自工作空间不干涉。</p>
<h3 data-number="1.11.3" id="核心程序模块"><span class="header-section-number">1.11.3</span> 11.3 核心程序模块</h3>
<h4 data-number="1.11.3.1" id="主要文件"><span class="header-section-number">1.11.3.1</span> 11.3.1 主要文件</h4>
<div class="sourceCode" id="cb20"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="ex">function_test/</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="ex">├──</span> dual_arm_simulation_trajectory.py    <span class="co"># 双臂轨迹生成器</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="ex">└──</span> test_dual_arm_simulation.py          <span class="co"># 仿真界面集成测试</span></span></code></pre></div>
<h4 data-number="1.11.3.2" id="核心类结构"><span class="header-section-number">1.11.3.2</span> 11.3.2 核心类结构</h4>
<p><strong>RobotPhysicalConfig类</strong>： - 存储机器人精确物理尺寸参数 - 提供左右臂安装位置配置 - 计算工作空间和臂展范围</p>
<p><strong>FR3SimulatedRobot类</strong>： - 模拟FR3机械臂API接口 - 实现简化正运动学计算 - 提供关节角度和末端位姿获取</p>
<p><strong>DualArmTrajectoryGenerator类</strong>： - 生成双臂协调运动轨迹 - 支持轨迹数据导出和导入 - 提供仿真系统集成接口</p>
<h3 data-number="1.11.4" id="内置测试轨迹"><span class="header-section-number">1.11.4</span> 11.4 内置测试轨迹</h3>
<h4 data-number="1.11.4.1" id="左臂照明轨迹"><span class="header-section-number">1.11.4.1</span> 11.4.1 左臂照明轨迹</h4>
<p><strong>动作描述</strong>: 抬手举起物体对前方照明 <strong>技术参数</strong>: - 起始关节角度: <code>[0.0, -20.0, -90.0, -90.0, 90.0, 0.0]</code> - 目标关节角度: <code>[-30.0, -45.0, -120.0, -60.0, 90.0, 0.0]</code> - 轨迹点数: 31点 - 运动范围: J1±30°, J2±25°, J3±30°</p>
<h4 data-number="1.11.4.2" id="右臂刷墙轨迹"><span class="header-section-number">1.11.4.2</span> 11.4.2 右臂刷墙轨迹</h4>
<p><strong>动作描述</strong>: 手臂前伸进行上下0.5m往复刷墙动作 <strong>技术参数</strong>: - 基础关节角度: <code>[30.0, -30.0, -90.0, -90.0, 90.0, 0.0]</code> - 垂直运动幅度: 40°关节角度变化 (约0.5m末端移动) - 轨迹点数: 51点<br />
- 运动模式: 正弦波上下往复 (2个完整周期)</p>
<h4 data-number="1.11.4.3" id="轨迹同步"><span class="header-section-number">1.11.4.3</span> 11.4.3 轨迹同步</h4>
<ul>
<li>自动同步左右臂轨迹长度</li>
<li>较短轨迹在末尾保持最后位置</li>
<li>最终同步长度: 51点</li>
<li>预估执行时间: 5.1秒 (100ms/点)</li>
</ul>
<h3 data-number="1.11.5" id="使用方法-1"><span class="header-section-number">1.11.5</span> 11.5 使用方法</h3>
<h4 data-number="1.11.5.1" id="生成和测试轨迹"><span class="header-section-number">1.11.5.1</span> 11.5.1 生成和测试轨迹</h4>
<div class="sourceCode" id="cb21"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 运行轨迹生成程序</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="ex">python3</span> function_test/dual_arm_simulation_trajectory.py</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 启动仿真界面集成测试  </span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="ex">python3</span> function_test/test_dual_arm_simulation.py</span></code></pre></div>
<h4 data-number="1.11.5.2" id="程序功能验证"><span class="header-section-number">1.11.5.2</span> 11.5.2 程序功能验证</h4>
<ul>
<li>✅ <strong>机器人状态读取</strong>: 模拟FR3 API获取当前关节角度和法兰位姿</li>
<li>✅ <strong>双臂轨迹生成</strong>: 基于物理约束生成协调运动轨迹<br />
</li>
<li>✅ <strong>数据导出功能</strong>: JSON格式保存轨迹数据和元信息</li>
<li>✅ <strong>仿真系统集成</strong>: 与现有仿真界面无缝对接</li>
</ul>
<h4 data-number="1.11.5.3" id="输出数据格式"><span class="header-section-number">1.11.5.3</span> 11.5.3 输出数据格式</h4>
<p>生成的JSON文件包含： - 轨迹元数据 (生成时间、机器人配置) - 左臂轨迹数组 (关节角度序列) - 右臂轨迹数组 (关节角度序列)<br />
- 当前机器人状态快照</p>
<h3 data-number="1.11.6" id="技术特点"><span class="header-section-number">1.11.6</span> 11.6 技术特点</h3>
<h4 data-number="1.11.6.1" id="无依赖运行"><span class="header-section-number">1.11.6.1</span> 11.6.1 无依赖运行</h4>
<ul>
<li>纯Python标准库实现</li>
<li>无需numpy等外部依赖</li>
<li>模拟FR3 API，无需实际硬件连接</li>
</ul>
<h4 data-number="1.11.6.2" id="精确物理建模"><span class="header-section-number">1.11.6.2</span> 11.6.2 精确物理建模</h4>
<ul>
<li>基于提供的精确尺寸数据</li>
<li>考虑左右臂安装位置和工作空间</li>
<li>符合实际机器人物理约束</li>
</ul>
<h4 data-number="1.11.6.3" id="仿真系统适配"><span class="header-section-number">1.11.6.3</span> 11.6.3 仿真系统适配</h4>
<ul>
<li>与现有ArmSimulationWidget完全兼容</li>
<li>支持轨迹可视化和动画播放</li>
<li>提供实时进度和状态反馈</li>
</ul>
<h3 data-number="1.11.7" id="调试和验证"><span class="header-section-number">1.11.7</span> 11.7 调试和验证</h3>
<p>该轨迹系统主要用于： - <strong>仿真系统调试</strong>: 验证双臂协调动画效果 - <strong>算法测试</strong>: 测试运动学计算和轨迹规划 - <strong>界面验证</strong>: 确保GUI控件正确显示机器人运动 - <strong>性能评估</strong>: 评估轨迹执行的流畅性和准确性</p>
<h3 data-number="1.11.8" id="fr3-api深度理解和轨迹实现方式"><span class="header-section-number">1.11.8</span> 11.8 FR3 API深度理解和轨迹实现方式</h3>
<p><em>更新时间：2025-07-08 18:45</em></p>
<h4 data-number="1.11.8.1" id="fr3-api核心函数体系"><span class="header-section-number">1.11.8.1</span> 11.8.1 FR3 API核心函数体系</h4>
<p>通过深入分析<code>fr3_control/example</code>和<code>fairino/Robot.py</code>，完全理解了FR3机械臂的API调用模式：</p>
<p><strong>状态读取函数</strong>：</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 获取当前关节角度(度)</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>error, current_joints <span class="op">=</span> robot.GetActualJointPosDegree()  <span class="co"># [j1,j2,j3,j4,j5,j6]</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 获取当前末端法兰位姿</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>error, flange_pose <span class="op">=</span> robot.GetActualToolFlangePose()  <span class="co"># [x,y,z,rx,ry,rz] mm/度</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 获取当前TCP位姿  </span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>error, tcp_pose <span class="op">=</span> robot.GetActualTCPPose()  <span class="co"># [x,y,z,rx,ry,rz] mm/度</span></span></code></pre></div>
<p><strong>运动学求解器</strong>：</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 正运动学：关节角度 → 末端位姿</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>error, pose <span class="op">=</span> robot.GetForwardKin(joint_pos)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 逆运动学：末端位姿 → 关节角度</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>error, joints <span class="op">=</span> robot.GetInverseKin(<span class="bu">type</span>, desc_pos, config)</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="co"># type: 0-绝对位姿, 1-相对位姿(基坐标), 2-相对位姿(工具坐标)</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="co"># config: -1参考当前位置求解, 0~7依据关节配置求解</span></span></code></pre></div>
<p><strong>运动控制方式</strong>：</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 关节空间运动</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>robot.MoveJ(joint_pos, tool<span class="op">=</span><span class="dv">0</span>, user<span class="op">=</span><span class="dv">0</span>, vel<span class="op">=</span><span class="dv">30</span>)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 笛卡尔直线运动</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>robot.MoveL(desc_pos, tool<span class="op">=</span><span class="dv">0</span>, user<span class="op">=</span><span class="dv">0</span>, vel<span class="op">=</span><span class="dv">30</span>)</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 伺服实时控制</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>robot.ServoMoveStart()</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>robot.ServoJ(joint_pos<span class="op">=</span>pos, axisPos<span class="op">=</span>[<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>])</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>robot.ServoMoveEnd()</span></code></pre></div>
<h4 data-number="1.11.8.2" id="标准轨迹实现流程"><span class="header-section-number">1.11.8.2</span> 11.8.2 标准轨迹实现流程</h4>
<p>基于真实FR3 API的正确轨迹实现方式：</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. 读取当前机械臂状态</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>error, current_joints <span class="op">=</span> robot.GetActualJointPosDegree()</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>error, current_flange_pose <span class="op">=</span> robot.GetActualToolFlangePose()</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. 根据相对运动需求计算目标位姿</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>target_pose <span class="op">=</span> current_flange_pose.copy()</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>target_pose[<span class="dv">0</span>] <span class="op">+=</span> <span class="dv">100</span>  <span class="co"># X方向前进100mm</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>target_pose[<span class="dv">2</span>] <span class="op">+=</span> <span class="dv">50</span>   <span class="co"># Z方向上升50mm</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. 调用逆运动学求解器</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>error, target_joints <span class="op">=</span> robot.GetInverseKin(<span class="dv">0</span>, target_pose, <span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. 执行运动到目标位置</span></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> error <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>    robot.MoveJ(target_joints, tool<span class="op">=</span><span class="dv">0</span>, user<span class="op">=</span><span class="dv">0</span>, vel<span class="op">=</span><span class="dv">20</span>)</span></code></pre></div>
<h4 data-number="1.11.8.3" id="胸口曲臂起始姿态定义"><span class="header-section-number">1.11.8.3</span> 11.8.3 胸口曲臂起始姿态定义</h4>
<p>基于人形双臂配置，设计合理的起始角度：</p>
<p><strong>左臂胸口曲臂姿态</strong> (类似人左手放在胸前)：</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>left_arm_chest_pose <span class="op">=</span> [<span class="op">-</span><span class="fl">30.0</span>, <span class="op">-</span><span class="fl">45.0</span>, <span class="op">-</span><span class="fl">120.0</span>, <span class="op">-</span><span class="fl">60.0</span>, <span class="fl">90.0</span>, <span class="fl">0.0</span>]</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="co"># J1: -30° (肩部内旋向胸部)</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="co"># J2: -45° (肩部下压)</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="co"># J3: -120° (肘部弯曲) </span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="co"># J4: -60° (腕部调整)</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="co"># J5: 90° (腕部竖直)</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="co"># J6: 0° (末端中性)</span></span></code></pre></div>
<p><strong>右臂胸口曲臂姿态</strong> (类似人右手放在胸前)：</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>right_arm_chest_pose <span class="op">=</span> [<span class="fl">30.0</span>, <span class="op">-</span><span class="fl">45.0</span>, <span class="op">-</span><span class="fl">120.0</span>, <span class="op">-</span><span class="fl">60.0</span>, <span class="fl">90.0</span>, <span class="fl">0.0</span>]</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="co"># J1: 30° (肩部内旋向胸部，与左臂对称)</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 其他关节与左臂一致</span></span></code></pre></div>
<h4 data-number="1.11.8.4" id="技术优势"><span class="header-section-number">1.11.8.4</span> 11.8.4 技术优势</h4>
<p>该起始姿态确保： - ✅ <strong>双臂不干涉</strong>: 左右臂工作空间完全分离 - ✅ <strong>工作空间优化</strong>: 处于机械臂舒适操作区域 - ✅ <strong>人形仿生</strong>: 模拟真实人体胸前操作姿态 - ✅ <strong>运动灵活性</strong>: 为各种相对运动提供充分空间</p>
<h4 data-number="1.11.8.5" id="应用价值"><span class="header-section-number">1.11.8.5</span> 11.8.5 应用价值</h4>
<ul>
<li><strong>API标准化</strong>: 基于真实FR3函数调用的标准实现</li>
<li><strong>轨迹可靠性</strong>: 使用官方运动学求解器确保精度</li>
<li><strong>仿真真实性</strong>: 起始姿态符合实际机器人物理约束</li>
<li><strong>开发效率</strong>: 为后续轨迹开发提供标准范式</li>
</ul>
<h2 data-number="1.12" id="机械臂仿真信息面板自适应优化"><span class="header-section-number">1.12</span> 12. 机械臂仿真信息面板自适应优化</h2>
<p><em>更新时间：2025-07-08 20:30</em></p>
<h3 data-number="1.12.1" id="问题描述-2"><span class="header-section-number">1.12.1</span> 12.1 问题描述</h3>
<p>FR3双臂机械臂仿真界面的信息面板存在空间浪费问题： - 信息框尺寸固定为250×200像素 - 实际文字内容占用空间较小，产生大量空白区域 - 影响仿真界面的视觉美观和空间利用率</p>
<h3 data-number="1.12.2" id="优化方案"><span class="header-section-number">1.12.2</span> 12.2 优化方案</h3>
<h4 data-number="1.12.2.1" id="自适应尺寸计算"><span class="header-section-number">1.12.2.1</span> 12.2.1 自适应尺寸计算</h4>
<p><strong>技术实现</strong>： - 使用<code>QFontMetrics</code>精确测量文字尺寸 - 动态计算所需的面板宽度和高度 - 根据文字内容自动调整面板边界</p>
<p><strong>核心算法</strong>：</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 计算最大文本宽度</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>max_text_width <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> text <span class="kw">in</span> info_texts:</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>    text_width <span class="op">=</span> fm.width(text)</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>    max_text_width <span class="op">=</span> <span class="bu">max</span>(max_text_width, text_width)</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 自适应面板尺寸</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>panel_w <span class="op">=</span> max_text_width <span class="op">+</span> padding_horizontal</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>panel_h <span class="op">=</span> <span class="bu">len</span>(info_texts) <span class="op">*</span> line_height <span class="op">+</span> (<span class="bu">len</span>(info_texts) <span class="op">-</span> <span class="dv">1</span>) <span class="op">*</span> line_spacing <span class="op">+</span> padding_vertical</span></code></pre></div>
<h4 data-number="1.12.2.2" id="优化细节参数"><span class="header-section-number">1.12.2.2</span> 12.2.2 优化细节参数</h4>
<p><strong>尺寸参数调整</strong>： - <strong>水平边距</strong>: 20px（左右各10px） - <strong>垂直边距</strong>: 30px（上下留白） - <strong>行间距</strong>: 4px（文字行之间的间隔） - <strong>背景透明度</strong>: 220（稍微增加，提升可读性）</p>
<p><strong>文字布局优化</strong>： - 精确的文字垂直对齐 - 使用字体上升高度计算起始位置 - 统一的行高和间距设置</p>
<h3 data-number="1.12.3" id="优化效果-1"><span class="header-section-number">1.12.3</span> 12.3 优化效果</h3>
<h4 data-number="1.12.3.1" id="空间利用改善"><span class="header-section-number">1.12.3.1</span> 12.3.1 空间利用改善</h4>
<p><strong>优化前</strong>： - 固定面板尺寸：250×200像素 - 大量无效空白区域 - 信息密度低</p>
<p><strong>优化后</strong>： - 动态面板尺寸：约200×140像素（根据内容） - 空间利用率提升约40% - 紧凑而清晰的信息显示</p>
<h4 data-number="1.12.3.2" id="视觉体验提升"><span class="header-section-number">1.12.3.2</span> 12.3.2 视觉体验提升</h4>
<ul>
<li>✅ <strong>减少视觉干扰</strong>: 移除多余空白，界面更整洁</li>
<li>✅ <strong>提升信息密度</strong>: 文字排列更紧凑合理</li>
<li>✅ <strong>增强专业感</strong>: 精确的尺寸控制，专业级显示效果</li>
<li>✅ <strong>适应性强</strong>: 轨迹信息动态显示时面板自动调整</li>
</ul>
<h4 data-number="1.12.3.3" id="技术亮点"><span class="header-section-number">1.12.3.3</span> 12.3.3 技术亮点</h4>
<ul>
<li><strong>精确测量</strong>: 基于字体度量的准确尺寸计算</li>
<li><strong>动态适应</strong>: 根据轨迹状态自动调整信息内容</li>
<li><strong>性能优化</strong>: 高效的文字布局算法</li>
<li><strong>跨平台兼容</strong>: 适应不同系统的字体渲染差异</li>
</ul>
<h3 data-number="1.12.4" id="代码实现要点"><span class="header-section-number">1.12.4</span> 12.4 代码实现要点</h3>
<h4 data-number="1.12.4.1" id="核心方法改进"><span class="header-section-number">1.12.4.1</span> 12.4.1 核心方法改进</h4>
<p><strong>文件</strong>: <code>gui/widgets/simulation_widget.py</code> <strong>方法</strong>: <code>draw_info_panel()</code></p>
<p><strong>关键改进</strong>：</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 文本内容数组化</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>info_texts <span class="op">=</span> [<span class="st">&quot;FR3 双臂机械臂仿真&quot;</span>, <span class="st">&quot;基座间距: 380mm&quot;</span>, ...]</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 字体度量计算</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>fm <span class="op">=</span> painter.fontMetrics()</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>max_text_width <span class="op">=</span> <span class="bu">max</span>(fm.width(text) <span class="cf">for</span> text <span class="kw">in</span> info_texts)</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 自适应尺寸</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>panel_w <span class="op">=</span> max_text_width <span class="op">+</span> padding_horizontal</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>panel_h <span class="op">=</span> <span class="bu">len</span>(info_texts) <span class="op">*</span> line_height <span class="op">+</span> spacing <span class="op">+</span> padding_vertical</span></code></pre></div>
<h4 data-number="1.12.4.2" id="布局算法优化"><span class="header-section-number">1.12.4.2</span> 12.4.2 布局算法优化</h4>
<ul>
<li>统一的文字行处理循环</li>
<li>精确的垂直位置计算</li>
<li>清晰的边距和间距管理</li>
</ul>
<h3 data-number="1.12.5" id="应用价值-1"><span class="header-section-number">1.12.5</span> 12.5 应用价值</h3>
<p>该优化特别适合： - <strong>专业仿真显示</strong>: 提供更专业的视觉效果 - <strong>空间受限场景</strong>: 在小屏幕或窗口中获得更好体验 - <strong>信息密集应用</strong>: 高效利用界面空间展示关键信息 - <strong>动态内容显示</strong>: 根据实时数据调整显示尺寸</p>
<h2 data-number="1.13" id="gui启动问题解决方案"><span class="header-section-number">1.13</span> 13. GUI启动问题解决方案</h2>
<p><em>更新时间：2025-07-08</em></p>
<h3 data-number="1.13.1" id="问题历史"><span class="header-section-number">1.13.1</span> 13.1 问题历史</h3>
<p>在v2.3.2版本回滚后，GUI出现了严重的启动和交互问题：</p>
<ol type="1">
<li><strong>启动卡死</strong>: 运行<code>python start_gui.py</code>后GUI窗口卡死，需要强制退出</li>
<li><strong>交互卡死</strong>: GUI虽能显示但点击任何位置都会卡死</li>
<li><strong>RobotSim选项卡缺失</strong>: RobotSim控件无法正常加载</li>
</ol>
<h3 data-number="1.13.2" id="根本原因分析"><span class="header-section-number">1.13.2</span> 13.2 根本原因分析</h3>
<p><strong>VTK循环导入问题</strong>: - 导入链: <code>start_gui.py</code> → <code>gui.main_window</code> → <code>robot_sim_widget</code> → <code>VTK import</code> - VTK在QApplication创建之前就被导入，导致初始化冲突 - 造成GUI启动时的阻塞和卡死</p>
<h3 data-number="1.13.3" id="解决方案-1"><span class="header-section-number">1.13.3</span> 13.3 解决方案</h3>
<h4 data-number="1.13.3.1" id="延迟导入策略"><span class="header-section-number">1.13.3.1</span> 13.3.1 延迟导入策略</h4>
<p><strong>修改文件</strong>: <code>gui/__init__.py</code></p>
<div class="sourceCode" id="cb30"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 修改前: 直接导入</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> .main_window <span class="im">import</span> XCRobotMainWindow</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 修改后: 延迟导入</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_main_window():</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>    <span class="im">from</span> .main_window <span class="im">import</span> XCRobotMainWindow</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> XCRobotMainWindow</span></code></pre></div>
<h4 data-number="1.13.3.2" id="主窗口创建流程优化"><span class="header-section-number">1.13.3.2</span> 13.3.2 主窗口创建流程优化</h4>
<p><strong>修改文件</strong>: <code>gui/main_window.py</code> - 重构控件创建和信号连接流程 - 同步创建所有控件(包括RobotSim) - 优化信号连接时序</p>
<h4 data-number="1.13.3.3" id="robotsim控件稳定性改进"><span class="header-section-number">1.13.3.3</span> 13.3.3 RobotSim控件稳定性改进</h4>
<p><strong>修改文件</strong>: <code>gui/widgets/robot_sim_widget.py</code></p>
<div class="sourceCode" id="cb31"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 添加缺失属性</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="va">self</span>.smooth_motion_enabled <span class="op">=</span> <span class="va">False</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="va">self</span>.target_joint_angles <span class="op">=</span> [<span class="fl">0.0</span>] <span class="op">*</span> <span class="dv">6</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="va">self</span>.current_joint_angles <span class="op">=</span> [<span class="fl">0.0</span>] <span class="op">*</span> <span class="dv">6</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="va">self</span>.motion_speed <span class="op">=</span> <span class="fl">0.1</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 延迟启动定时器</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>QTimer.singleShot(<span class="dv">1000</span>, <span class="kw">lambda</span>: <span class="va">self</span>.update_timer.start(<span class="dv">100</span>))</span></code></pre></div>
<h4 data-number="1.13.3.4" id="启动脚本优化"><span class="header-section-number">1.13.3.4</span> 13.3.4 启动脚本优化</h4>
<p><strong>修改文件</strong>: <code>start_gui.py</code></p>
<div class="sourceCode" id="cb32"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 修改前: 直接导入</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> main_window <span class="im">import</span> XCRobotMainWindow</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 修改后: 延迟导入</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> gui <span class="im">import</span> get_main_window</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>XCRobotMainWindow <span class="op">=</span> get_main_window()</span></code></pre></div>
<h3 data-number="1.13.4" id="当前状态"><span class="header-section-number">1.13.4</span> 13.4 当前状态</h3>
<p>✅ <strong>已解决的问题</strong>: - GUI启动不再卡死 - 所有5个选项卡正常显示 - RobotSim控件成功创建 - 用户交互正常响应 - 所有控件信号正常连接</p>
<p>⚠️ <strong>仍存在的轻微问题</strong>: - 字体警告: <code>Missing font family "Microsoft YaHei"</code> - 布局警告: <code>QLayout::addChildLayout: layout "" already has a parent</code></p>
<p>这些警告不影响功能使用。</p>
<h3 data-number="1.13.5" id="使用方法-2"><span class="header-section-number">1.13.5</span> 13.5 使用方法</h3>
<p><strong>标准启动流程</strong>:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. 激活虚拟环境</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="bu">source</span> venv/bin/activate</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. 启动GUI</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> start_gui.py</span></code></pre></div>
<h3 data-number="1.13.6" id="技术细节"><span class="header-section-number">1.13.6</span> 13.6 技术细节</h3>
<p><strong>核心设计思路</strong>: 采用”先创建QApplication，再导入VTK组件”的策略，彻底解决VTK初始化时序问题。</p>
<p><strong>修改的关键文件</strong>: - <code>gui/__init__.py</code> - 延迟导入机制 - <code>gui/main_window.py</code> - 主窗口创建流程 - <code>gui/widgets/robot_sim_widget.py</code> - RobotSim控件稳定性 - <code>start_gui.py</code> - 启动脚本优化</p>
<h2 data-number="1.14" id="下一步"><span class="header-section-number">1.14</span> 14. 下一步</h2>
<p>完成基础测试后，你可以： - 修改<code>integrated_controller.py</code>中的动作序列 - 添加新的工作站位置 - 使用优化后的GUI界面进行仿真测试 - 使用底盘相对移动功能进行路径规划 - 利用新增的仿真控制功能验证底盘运动逻辑 - <strong>使用双臂轨迹系统调试和验证机械臂仿真功能</strong> - <strong>基于FR3 API标准实现更复杂的协调轨迹</strong></p>
</body>
</html>
